{% extends "base.html" %}

{% block title %}–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ: {{ event.name }} - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="admin-header">
        <h1>{{ event.name }}</h1>
        <div class="action-buttons">
            <a href="{{ url_for('admin_event_edit', event_id=event.id) }}" class="btn btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            {% if current_stage and current_stage.info.type == 'registration_closed' %}
            <a href="{{ url_for('admin_event_review', event_id=event.id) }}" class="btn btn-success">–†–µ–≤—å—é —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</a>
            {% endif %}
            <a href="{{ url_for('admin_events') }}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
        </div>
    </div>
    
    <div class="event-view-card">
        <div class="event-info-section">
            <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
            <p>{{ event.description or '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ' }}</p>
        </div>
        
        <div class="event-info-section">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="info-row">
                <span class="info-label">–°–æ–∑–¥–∞–Ω–æ:</span>
                <span class="info-value">{{ event.created_at }}</span>
            </div>
            {% if event.updated_at and event.updated_at != event.created_at %}
            <div class="info-row">
                <span class="info-label">–û–±–Ω–æ–≤–ª–µ–Ω–æ:</span>
                <span class="info-value">{{ event.updated_at }}</span>
            </div>
            {% endif %}
        </div>
        
        <div class="event-info-section">
            <h3>üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ (–ë—É–±–µ–Ω—á–∏–∫–∏)</h3>
            <div class="info-row">
                <span class="info-label">–ó–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é:</span>
                <span class="info-value">
                    {% if event.rating_registration is not none %}
                        <strong>{{ event.rating_registration }}</strong> <span class="text-muted">(–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% else %}
                        {{ global_rating_registration }} <span class="text-muted">(–≥–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% endif %}
                </span>
            </div>
            <div class="info-row">
                <span class="info-label">–ó–∞ –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫:</span>
                <span class="info-value">
                    {% if event.rating_gift_not_sent is not none %}
                        <strong>{{ event.rating_gift_not_sent }}</strong> <span class="text-muted">(–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% else %}
                        {{ global_rating_gift_not_sent }} <span class="text-muted">(–≥–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% endif %}
                </span>
            </div>
            <div class="info-row">
                <span class="info-label">–ó–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫:</span>
                <span class="info-value">
                    {% if event.rating_gift_sent is not none %}
                        <strong>{{ event.rating_gift_sent }}</strong> <span class="text-muted">(–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% else %}
                        {{ global_rating_gift_sent }} <span class="text-muted">(–≥–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% endif %}
                </span>
            </div>
            <div class="info-row">
                <span class="info-label">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞ –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å:</span>
                <span class="info-value">
                    {% if event.rating_order_coefficient is not none %}
                        <strong>{{ event.rating_order_coefficient }}</strong> <span class="text-muted">(–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</span>
                    {% else %}
                        <span class="text-muted">–ù–µ –∑–∞–¥–∞–Ω</span>
                    {% endif %}
                </span>
            </div>
            <p class="form-hint" style="margin-top: 0.5rem; font-size: 0.875rem;">
                –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –Ω–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
            </p>
        </div>
        
        <div class="event-stages-section">
            <h3>–≠—Ç–∞–ø—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h3>
            
            {% for stage_item in stages_with_info %}
            {% set stage = stage_item.data %}
            {% set stage_info = stage_item.info %}
            <div class="stage-card">
                <div class="stage-header">
                    <h4>
                        {{ stage_info.name }}
                        {% if stage_info.required %}<span class="required">*</span>{% endif %}
                        {% if not stage_info.required %}<span class="optional">(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>{% endif %}
                    </h4>
                </div>
                
                <div class="stage-details">
                    {% if stage %}
                        {% if stage.start_datetime %}
                        <div class="info-row">
                            <span class="info-label">–ù–∞—á–∞–ª–æ:</span>
                            <span class="info-value">{{ stage.start_datetime }}</span>
                        </div>
                        {% endif %}
                        
                        {% if stage.end_datetime %}
                        <div class="info-row">
                            <span class="info-label">–û–∫–æ–Ω—á–∞–Ω–∏–µ:</span>
                            <span class="info-value">{{ stage.end_datetime }}</span>
                        </div>
                        {% elif not stage_info.has_end %}
                        <div class="info-row">
                            <span class="info-label">–û–∫–æ–Ω—á–∞–Ω–∏–µ:</span>
                            <span class="info-value">–î–æ –Ω–∞—á–∞–ª–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç—Ç–∞–ø–∞</span>
                        </div>
                        {% endif %}
                    {% else %}
                        <div class="info-row">
                            <span class="info-value text-muted">–≠—Ç–∞–ø –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</span>
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

