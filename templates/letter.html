{% extends "base.html" %}

{% block title %}–ü–∏—Å—å–º–æ - –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –î–µ–¥—ã –ú–æ—Ä–æ–∑—ã{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="admin-container">
        <div class="admin-header">
            <div>
                <h1>‚úâÔ∏è –ü–∏—Å—å–º–æ –î–µ–¥—É –ú–æ—Ä–æ–∑—É</h1>
                <p class="text-muted" style="margin: 0;">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ: {{ letter.event_name }}</p>
            </div>
            <a href="{{ url_for('assignments') }}" class="btn btn-secondary">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∑–∞–¥–∞–Ω–∏—è–º</a>
        </div>

        {% if available_letters|length > 1 %}
        <div class="card" style="margin-bottom: 1.5rem;">
            <div class="card-body" style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
                <span class="text-muted" style="align-self: center;">–î—Ä—É–≥–∏–µ –ø–∏—Å—å–º–∞:</span>
                {% for item in available_letters %}
                <a 
                    href="{{ url_for('letter', assignment_id=item.assignment_id) }}"
                    class="btn btn-sm {% if assignment.id == item.assignment_id %}btn-primary{% else %}btn-outline-primary{% endif %}"
                >
                    {{ item.event_name }} ¬∑ {{ item.recipient_name }}
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <div class="event-view-card" style="max-width: 960px; margin: 0 auto;">
            <style>
                .chat-wrapper {
                    display: flex;
                    flex-direction: column;
                    gap: 1.25rem;
                }
                .chat-message {
                    max-width: 72%;
                    padding: 1rem 1.25rem;
                    border-radius: 16px;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
                    position: relative;
                    line-height: 1.55;
                }
                .chat-message::after {
                    content: "";
                    position: absolute;
                    width: 12px;
                    height: 12px;
                    background: inherit;
                    bottom: -6px;
                    transform: rotate(45deg);
                }
                .message-grandchild {
                    align-self: flex-start;
                    background: linear-gradient(135deg, #fbc2eb 0%, #a18cd1 100%);
                    color: white;
                }
                .message-grandchild::after {
                    left: 24px;
                }
                .message-santa {
                    align-self: flex-end;
                    background: linear-gradient(135deg, #f7f7fb 0%, #ebefff 100%);
                    border: 1px solid rgba(102, 126, 234, 0.18);
                    color: #364152;
                }
                .message-grandchild {
                    right: 24px;
                }
                .message-santa::after {
                    right: 24px;
                    border-left: 1px solid rgba(102, 126, 234, 0.18);
                    border-bottom: 1px solid rgba(102, 126, 234, 0.18);
                }
                .chat-meta {
                    display: block;
                    font-size: 0.85rem;
                    opacity: 0.8;
                    margin-top: 0.75rem;
                }
            </style>

            <div class="chat-wrapper">
                <div class="chat-message message-grandchild">
                    <strong>‚ú® {{ letter.first_name }}:</strong>
                    <div style="margin-top: 0.5rem;">
                        <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π, –î–µ–¥—É—à–∫–∞ –ú–æ—Ä–æ–∑! –ú–µ–Ω—è –∑–æ–≤—É—Ç <strong>{{ letter.first_name }}</strong>, –∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é <strong>{{ letter.full_name }}</strong>. –ü–∏—à—É —Ç–µ–±–µ –∏–∑ <strong>{{ letter.address }}</strong>. –í–µ—Å—å –≥–æ–¥ —è –≤—ë–ª —Å–µ–±—è —Ö–æ—Ä–æ—à–æ, –∑–∞–±–æ—Ç–∏–ª—Å—è –æ —Ä–æ–¥–Ω—ã—Ö –∏ –¥—Ä—É–∑—å—è—Ö, —Å–¥–µ–ª–∞–ª –º–Ω–æ–≥–æ —Ö–æ—Ä–æ—à–µ–≥–æ –∏ —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º –∂–¥—É –≤–æ–ª—à–µ–±—Å—Ç–≤–∞ –∏ —á—É–¥–µ—Å, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –¥–∞—Ä–∏—à—å –≤—Å–µ–º –¥–µ—Ç—è–º.</p>

                        <p>–ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤ –æ —Å–µ–±–µ: <span style="white-space: pre-wrap;">{{ letter.bio }}</span></p>

                        <p>–°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ –∑–∞ –≤—Å—ë, —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å! –ñ–µ–ª–∞—é —Ç–µ–±–µ –∫—Ä–µ–ø–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Å—á–∞—Å—Ç—å—è. –ù–∞–¥–µ—é—Å—å, —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –≥–æ–¥—É —è —Å–Ω–æ–≤–∞ —Å–º–æ–≥—É –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ–±–µ –ø–∏—Å—å–º–æ –∏ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ –Ω–æ–≤—ã–º–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏!</p>

                        <p style="margin-top: 1.5rem;">–° –ª—é–±–æ–≤—å—é, <strong>{{ letter.first_name }}</strong></p>
                    </div>
                    <span class="chat-meta">{{ letter.date }}</span>
                </div>

                <div class="chat-message message-santa">
                    <strong>üéÖ –î–µ–¥ –ú–æ—Ä–æ–∑:</strong>
                    <p style="margin-top: 0.5rem;">
                        –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–∏—Å—å–º–æ, {{ letter.first_name }}! –Ø –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≥–ª—è–Ω—É –∫ —Ç–µ–±–µ. –ñ–µ–ª–∞—é —Ç–µ–±–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∂–µ–ª–∞–Ω–∏–π –∏ —Å–∞–º—ã—Ö —Ç—ë–ø–ª—ã—Ö —á—É–¥–µ—Å!
                    </p>
                    <span class="chat-meta">–°–µ–≤–µ—Ä–Ω—ã–π –ø–æ–ª—é—Å ¬∑ –≤–æ–ª—à–µ–±–Ω–∞—è –ª–∏–Ω–∏—è —Å–≤—è–∑–∏</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}


